#include "Cube.h"
#include <malloc.h>
#include <chrono>

#define LOGI(...) ((void)__android_log_print(ANDROID_LOG_INFO, "AndroidProject1.NativeActivity", __VA_ARGS__))
#define LOGW(...) ((void)__android_log_print(ANDROID_LOG_WARN, "AndroidProject1.NativeActivity", __VA_ARGS__))

int WIDTH = 1;
int HEIGHT = 1;

int mouseX = 0;
int mouseY = 0;
int pmouseX = 0;
int pmouseY = 0;

Player myPlayer;
bool isMousePressed = false;
engine* cur_engine;


float ApproxAtan(float z)
{
	const float n1 = 0.97239411f;
	const float n2 = -0.19194795f;
	return (n1 + n2 * z * z) * z;
}

float ApproxAtan2(float y, float x)
{
	if (x != 0.0f)
	{
		if (fabsf(x) > fabsf(y))
		{
			const float z = y / x;
			if (x > 0.0)
			{
				// atan2(y,x) = atan(y/x) if x > 0
				return ApproxAtan(z);
			}
			else if (y >= 0.0)
			{
				// atan2(y,x) = atan(y/x) + PI if x < 0, y >= 0
				return ApproxAtan(z) + M_PI;
			}
			else
			{
				// atan2(y,x) = atan(y/x) - PI if x < 0, y < 0
				return ApproxAtan(z) - M_PI;
			}
		}
		else // Use property atan(y/x) = PI/2 - atan(x/y) if |y/x| > 1.
		{
			const float z = x / y;
			if (y > 0.0)
			{
				// atan2(y,x) = PI/2 - atan(x/y) if |y/x| > 1, y > 0
				return -ApproxAtan(z) + M_PI_2;
			}
			else
			{
				// atan2(y,x) = -PI/2 - atan(x/y) if |y/x| > 1, y < 0
				return -ApproxAtan(z) - M_PI_2;
			}
		}
	}
	else
	{
		if (y > 0.0f) // x = 0, y > 0
		{
			return M_PI_2;
		}
		else if (y < 0.0f) // x = 0, y < 0
		{
			return -M_PI_2;
		}
	}
	return 0.0f; // x,y = 0. Could return NaN instead.
}





static int engine_init_display(struct engine* engine) {

	const EGLint attribs[] = {
		EGL_SURFACE_TYPE, EGL_WINDOW_BIT,
		EGL_BLUE_SIZE, 8,
		EGL_GREEN_SIZE, 8,
		EGL_RED_SIZE, 8,
		EGL_NONE
	};
	EGLint w, h, format;
	EGLint numConfigs;
	EGLConfig config;
	EGLSurface surface;
	EGLContext context;

	EGLDisplay display = eglGetDisplay(EGL_DEFAULT_DISPLAY);

	eglInitialize(display, 0, 0);
	eglChooseConfig(display, attribs, &config, 1, &numConfigs);
	eglGetConfigAttrib(display, config, EGL_NATIVE_VISUAL_ID, &format);
	ANativeWindow_setBuffersGeometry(engine->app->window, 0, 0, format);
	surface = eglCreateWindowSurface(display, config, engine->app->window, NULL);
	context = eglCreateContext(display, config, NULL, NULL);

	if (eglMakeCurrent(display, surface, surface, context) == EGL_FALSE) {
		LOGW("Unable to eglMakeCurrent");
		return -1;
	}

	eglQuerySurface(display, surface, EGL_WIDTH, &w);
	eglQuerySurface(display, surface, EGL_HEIGHT, &h);

	engine->display = display;
	engine->context = context;
	engine->surface = surface;
	engine->width = w;
	engine->height = h;
	engine->state.angle = 0;

	WIDTH = w;
	HEIGHT = h;
	double width = w;
	double height = h;

	glDisable(GL_DITHER);
	glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_FASTEST);

	//glEnable(GL_CULL_FACE);
	glShadeModel(GL_SMOOTH);
	//glEnable(GL_DEPTH_TEST);

	glViewport(0, 0, width, height);
	GLfloat ratio = (GLfloat)width / height;
	glMatrixMode(GL_PROJECTION);
	glLoadIdentity();
	glFrustumf(-ratio, ratio, -1, 1, 0.1, 1000);

	glEnable(GL_TEXTURE_2D);
	glEnable(GL_BLEND);
	glBlendFunc(GL_ONE, GL_SRC_COLOR);


	setup_program();

	return 0;
}

static void engine_draw_frame(struct engine* engine) {
	if (engine->display == NULL) {
		return;
	}
	LOGI("MoinI Sebi  \n");
	LOGW("MoinW Sebi  \n");
	draw_program();
	eglSwapBuffers(engine->display, engine->surface);
}


static void engine_term_display(struct engine* engine) {
	if (engine->display != EGL_NO_DISPLAY) {
		eglMakeCurrent(engine->display, EGL_NO_SURFACE, EGL_NO_SURFACE, EGL_NO_CONTEXT);
		if (engine->context != EGL_NO_CONTEXT) {
			eglDestroyContext(engine->display, engine->context);
		}
		if (engine->surface != EGL_NO_SURFACE) {
			eglDestroySurface(engine->display, engine->surface);
		}
		eglTerminate(engine->display);
	}
	engine->animating = 0;
	engine->display = EGL_NO_DISPLAY;
	engine->context = EGL_NO_CONTEXT;
	engine->surface = EGL_NO_SURFACE;

	tearDownGL();
}

static int32_t engine_handle_input(struct android_app* app, AInputEvent* event) {
	struct engine* engine = (struct engine*)app->userData;
	int32_t event_type = AInputEvent_getType(event);
	int32_t event_device = AInputEvent_getDeviceId(event);
	int32_t event_source = AInputEvent_getSource(event);
	int32_t event_action = AMotionEvent_getAction(event);

	int32_t event_flags = AKeyEvent_getFlags(event);
	int32_t event_code = AKeyEvent_getKeyCode(event);

	if (event_type == AINPUT_EVENT_TYPE_MOTION)
	{
		engine->state.x = AMotionEvent_getX(event, 0);
		engine->state.y = AMotionEvent_getY(event, 0);

		pmouseX = mouseX;
		pmouseY = mouseY;
		mouseX = AMotionEvent_getX(event, 0);
		mouseY = AMotionEvent_getY(event, 0);

		if (event_action == AKEY_EVENT_ACTION_DOWN)
		{
			//myPlayer.angx = 1;
			isMousePressed = true;
			//println("down " + float_to_string(MOUSEX) + " "+ float_to_string(MOUSEY));
			return 1;
		}
		if (event_action == AKEY_EVENT_ACTION_UP)
		{
			isMousePressed = false;
			//myPlayer.angx = 0;
			//println("up " + float_to_string(MOUSEX) + " " + float_to_string(MOUSEY));
			return 1;
		}
		if (event_action == AMOTION_EVENT_ACTION_MOVE)
		{
			if (!myPlayer.isPlayerMouse())
			{
				float speed = 360 / (float)(MIN(WIDTH, HEIGHT));
				myPlayer.angy += speed * (mouseX - pmouseX);
				myPlayer.angx += speed * (mouseY - pmouseY);
			}
			int num = AMotionEvent_getPointerCount(event);
			println("AMOTION_EVENT_ACTION_MOVE num " + int_to_string(num));

			return 1;
		}

		//println("other "+ int_to_string (event_action)+" "+ float_to_string(MOUSEX) + " " + float_to_string(MOUSEY));

		println("new event_type " + int_to_string(event_type));
		println("new event_device " + int_to_string(event_device));
		println("new event_source " + int_to_string(event_source));


		println("new event_flags " + int_to_string(event_flags));
		println("new event_code " + int_to_string(event_code));
		println("");
		return 1;
	}


	return 0;

	//AMotionEvent_getX   AMotionEvent_getRawX
	//AINPUT_EVENT_TYPE_MOTION AINPUT_EVENT_TYPE_KEY
}

static void engine_handle_cmd(struct android_app* app, int32_t cmd) {
	struct engine* engine = (struct engine*)app->userData;
	switch (cmd) {
	case APP_CMD_SAVE_STATE:
		engine->app->savedState = malloc(sizeof(struct saved_state));
		*((struct saved_state*)engine->app->savedState) = engine->state;
		engine->app->savedStateSize = sizeof(struct saved_state);
		break;
	case APP_CMD_INIT_WINDOW:
		if (engine->app->window != NULL) {
			engine_init_display(engine);
			engine_draw_frame(engine);
		}
		break;
	case APP_CMD_TERM_WINDOW:
		engine_term_display(engine);
		break;
	case APP_CMD_GAINED_FOCUS:
		if (engine->accelerometerSensor != NULL) {
			ASensorEventQueue_enableSensor(engine->sensorEventQueue,
				engine->accelerometerSensor);
			ASensorEventQueue_setEventRate(engine->sensorEventQueue,
				engine->accelerometerSensor, (1000L / 60) * 1000);
		}
		break;
	case APP_CMD_LOST_FOCUS:
		if (engine->accelerometerSensor != NULL) {
			ASensorEventQueue_disableSensor(engine->sensorEventQueue,
				engine->accelerometerSensor);
		}
		engine->animating = 0;
		engine_draw_frame(engine);
		break;
	}
}


std::chrono::high_resolution_clock::time_point begin_millis_timer;
void android_main(struct android_app* state) {
	struct engine engine;

	memset(&engine, 0, sizeof(engine));
	state->userData = &engine;
	state->onAppCmd = engine_handle_cmd;
	state->onInputEvent = engine_handle_input;
	engine.app = state;

	cur_engine = &engine;
	begin_millis_timer = std::chrono::high_resolution_clock::now();

	engine.sensorManager = ASensorManager_getInstance();
	engine.accelerometerSensor = ASensorManager_getDefaultSensor(engine.sensorManager,
		ASENSOR_TYPE_ACCELEROMETER);
	engine.sensorEventQueue = ASensorManager_createEventQueue(engine.sensorManager,
		state->looper, LOOPER_ID_USER, NULL, NULL);

	if (state->savedState != NULL) {
		engine.state = *(struct saved_state*)state->savedState;
	}

	engine.animating = 1;

	while (1) {
		int ident;
		int events;
		struct android_poll_source* source;

		while ((ident = ALooper_pollAll(engine.animating ? 0 : -1, NULL, &events,
			(void**)&source)) >= 0) {

			if (source != NULL) {
				source->process(state, source);
			}

			if (ident == LOOPER_ID_USER) {
				if (engine.accelerometerSensor != NULL) {
					ASensorEvent event;
					while (ASensorEventQueue_getEvents(engine.sensorEventQueue,
						&event, 1) > 0) {
						LOGI("accelerometer: x=%f y=%f z=%f",
							event.acceleration.x, event.acceleration.y,
							event.acceleration.z);
					}
				}
			}

			if (state->destroyRequested != 0) {
				engine_term_display(&engine);
				return;
			}
		}

		if (engine.animating) {
			//Cube_update();
			//if (engine.state.angle > 1) {
			//	engine.state.angle = 0;
			//}

			engine_draw_frame(&engine);
		}
	}
}





//////////////////////////////////////////////
/*				3d Render					*/
//////////////////////////////////////////////
GLubyte stone_data[] = "0071004700110255007500520020025500950075004802550127010900870255008700690049025501510130011102550149012501010255012400980071025501330103007702550146011900920255012100950072025500980073005302550080005400390255005700310018025500870058004402550116008700710255012200950074025500960070004702550120009300740255013001030084025501320107008702550120009500730255012801030081025500680044001802550081005800270255010800850053025501220099006502550134011100770255012301000068025500860063003202550092006800400255007300490023025500790058003102550082006100340255007000480024025500850063003902550078005600330255008000580035025500760055003402550063004200210255009400730054025500490028000902550068004900320255007800590042025500830066004602550075005800380255007200550035025500570039001902550087006600490255008800650049025501000074006102550068004200290255008900590048025501120084007202550117008900750255010300800062025501340111009302550130010900880255013101130091025501260108008602550080005900400255015801370118025501010075006002550091006500500255008100560025025500990078004702550120010000760255008700700050025500750056003902550078005900420255008400590037025501110085006002550111008400570255015001230096025501360112008802550105008300620255006600430025025500850059004402550076004800340255008400570040025501120085006402550070004500230255008800630041025501130088006802550131010600860255010300810058025500600038001402550049002800010255005800370008025500740053002202550090007000370255011200920059025500930072004102550110008900580255009700760049025500580037001002550078005600320255005400320008025500690047002302550100007800550255009200700047025501040082006102550075005400330255006300420023025500690048002902550083006200430255008200630046025500850066004902550062004500250255008300660046025500600043002302550071005400340255010000820062025500920071005402550071004800320255006500420028025500620036002302550095006900540255005900360020025500520031001202550053003200130255007800600038025500710055003202550121010400840255011700990079025500820063004602550034001100000255004100180002025500840060003402550090007000450255010500870067025500560040002402550052003400200255008100630049025501470124010602550150012601020255011800940068025500850061003302550082006000360255010800880064025501240103008202550143012201010255014501230102025500950073005202550080005800370255009600740051025500950073005002550085006300400255009000680045025500500030000502550064004400190255008800680043025500920072004502550143012300960255012201020075025501270107008002550106008600590255008000600033025500880068004102550052003200070255007800580034025500730053002902550098007800540255008100600039025500890068004702550091007000510255005800370018025500770056003902550097007600590255010500840067025500910072005502550062004300260255006600480028025500500032001202550071005400340255005400370017025500690054003302550087007000500255006900510031025500620043002602550074005300360255007100500033025500700051003402550046002900090255005100340014025500620047002602550068005600340255005900470025025500640049003002550078006200460255007600570042025500760057004202550075005300300255007900610041025500700053003702550054004000270255005900450034025500130000000002550156013701200255015401330112025501440122009802550118009700700255010500850060025500780060003602550111009300710255009100730051025501180098007402550074005300320255007100530033025500940076005602550046002800060255005800400016025500460028000402550068005000260255008500690044025500360020000002550038002200000255007400580035025501020086006302550122010600830255012501070085025501030087006202550107009000640255007700610036025500840068004502550070005300330255005900420022025500520035001502550063004600260255006000410024025500800061004402550072005300360255005800390022025500600041002402550057004000220255008900720054025500860069004902550067005000300255008700720051025501000085006402550102009000660255009500830059025500940079005602550055003800180255008900720054025501000083006502550087007000500255006100460025025500700058003602550078006700450255007300620040025500610050003002550054004100240255003700240008025500600044002902550067005100360255008600650048025501190102008602550060004400310255006100480039025500560043003402550024001000000255007600580044025501110093007302550144012401000255013601190093025501090093006802550106009200660255008600710048025500590044002102550134011800930255009500790056025501230107009102550103008700720255005500400021025500750060003902550063004800250255007200570034025500900075005202550124010900880255007500600041025500330017000102550085006900530255008600700054025501060089007302550085007000510255007400570037025500650050002902550076006500450255009200810061025500780067004702550082007100510255005700460026025500420029001202550038002500080255007300600043025500530040002302550038002500080255006800550036025500680055003602550091007900570255007100590037025500670055003302550078006800430255006900590032025500770067004002550076006400400255005100360013025500960081006002550096008100600255010900940073025500660054003202550075006300410255006700560034025500810070005002550067005900380255007300620044025500650052003602550075006100480255009400800067025501160097008202550066004800340255002600120000025500710058004902550065005500450255005000380026025500420026001102550066004900310255009600780058025500930077005402550085007000470255007900670043025500910079005502550118010600820255009400790056025500900075005402550067005300400255009400800069025500490036002002550070005700400255010600930074025501140102008002550126011300940255012401110094025500670054003802550107009300800255005900420032025500650049003602550054003800250255007000540039025500540038002202550046003300140255008100730054025500870078006102550090008100640255009400850068025500220010000002550038002700090255006200490032025500630050003302550091007800610255010000870070025500680055003602550040002700080255006500530031025500510039001702550071005900370255006200500026025500600050002302550047003700100255005000380014025500410026000302550064004900280255011400990078025500900075005402550070005800360255006900570035025500670055003302550057004600260255006500540034025500810068005102550054004100250255009000760063025501060092008102550134011500980255003100140000025500560043002702550085007300590255004800380026025500630053004102550059004600300255005700410025025500360019000102550058004100210255006000450024025501020090006802550117010500830255011601040082025501080093007202550069005300370255008200680059025500460033002502550047003500230255002800160002025500810069005302550080006800520255011801060090025500830071005702550107009500830255006300510039025500480034002502550074006000510255003400200011025500490035002402550038002400110255005700440028025500390027001302550055004300290255006700550041025500490037002302550026001200000255006700540038025501000084006902550100008400690255009800810065025500590042002602550057004000220255006100440026025500550038001802550074005700370255006500480028025500440027000702550085007000470255007300580035025500920077005402550136011900990255012101040084025501030086006602550100008300630255012101040084025501150099007602550077006200390255008800730052025500830068004902550076006000440255006200460031025500970081006802550152013601230255010100820065025500310014000002550060004700300255013101190103025500980089007402550058004900340255003300200004025500520036002102550058004100250255005800410023025500310016000002550040002800060255006400520030025500620050002802550077006000400255007100540038025500500036002502550060004700380255008000660057025500350023001102550046003200190255003900270013025501070093008002550073006100470255009200780067025500710057004602550052003800270255003500210010025500550041003002550049003500220255004400300017025500380026001202550026001400020255004200320020025500450033002102550039002700150255002300090000025500360023000702550103008700720255010900930077025501190102008602550101008400660255010100840066025500680051003302550092007500550255009000730053025500630046002602550086006900490255009800810061025500810066004502550064004700270255008100640044025500670050003202550123010600860255011901010081025501160098007802550124010600840255012101050082025500980080005802550103008600660255011700980081025500710054003802550070005200380255013601180104025500800059004202550046002700100255002600100000025500160004000002550018000600000255003200200004025500840068005302550114009600820255011200930078025500770060004202550062004700260255007600610038025500460031000802550035002000000255005500370015025500560038001802550050003400190255003000160003025500340018000502550046003200190255003200160003025500240010000002550077006100460255007500620046025500600044002902550084006800520255009100750059025500820066005002550065005200350255005300400023025500530040002402550034002200080255008400760063025500760070005802550062005400410255001600080000025500240015000002550070005800420255010500920076025500960083006602550101008500690255010400890070025500910076005702550076006100400255005200370016025500900075005402550078006300420255007400590038025500890072005402550069005200340255007300560038025500590042002402550060004300270255006600490031025501110093007302550110009200720255011200940072025501300112009002550143012201010255008200640042025500960075005402550083006500450255002500060000025500800061004602550140011701030255006700480033025500260009000002550045003200150255004900360019025500720059004302550130011200980255012401050090025500870068005302550141012301030255015801420117025501470131010502550141012600970255016101460117025501350115009002550098007800530255010000820060025500850068004802550045002800100255002900120000025500210004000002550041002400080255006100440028025500700053003502550085006800480255009400790056025501360122009602550107009300670255008700720049025500890077005502550097008400650255008900770061025500640056004302550084007600630255005300450032025500880079006402550041002900130255006200490032025501110098008102550089007400550255009100760057025500600045002402550079006400430255012701120091025500760061004002550089007400530255008300680047025500840069005002550090007400580255009200760061025500840068005302550087007100550255008000640048025500580042002602550054003700190255009200740054025501130095007302550138011800940255011600960072025500990079005502550077005900370255005000320010025500860068004802550091007400540255012600990088025500660044003102550101008200670255008800730054025500560043002402550078006200460255005200330018025500560034002002550095007400550255019501750151025501970177015002550153013701040255018401680134025501700152011602550171014801140255014501220090025501020081005002550133011400840255012301030078025501180098007402550060004200180255004700290005025500840066004202550081006400380255006400470019025500730058002702550110009500620255012001070075025501190105007602550104009000630255006300480025025500780065004602550078006500490255008800740061025500690055004202550096008000650255006500480032025500630044002702550093007400570255008100600041025500750054003502550079005800370255010400830062025501000079005802550105008400650255010800870068025500870069004902550074005700390255007300570042025500590045003202550046003400200255004900370021025500650052003602550045003200150255007300580039025500990084006302550110009400710255011000920068025501120094007002550096007900530255007300570032025501240109008602550088007300500255004500300007025501240097008602550079005600420255013301140097025500970080006002550079006400430255005900440023025500210002000002550108008500690255009300710050025500930071004702550109008800570255014001220084025501990180014002550196017701350255019201690128025501480125008402550133011100720255016001380101025501620139010702550165014401130255011900980069025501250104007502550068004700180255012301040072025501370118008502550121010500710255010800920058025501110097006202550103008800570255006300490020025501150101007502550117010200810255005200360020025500710055004002550102008600710255006000430027025500260007000002550047002600070255006800470028025500900068004702550085006300420255008100590038025501070085006402550087006600450255009100700051025500770056003702550060004200220255006800510033025500670053004002550052004200300255006100520037025500560047003202550051004200250255002600150000025500700059003902550094008200580255008900740051025501060090006502550101008400580255006400480022025500940078005302550146013201060255009500830059025501390127010302550100007200600255010400780063025500880070004802550118010200770255012801140087025501040088006302550046002500040255008300610040025500900065004302550155013101050255013401110077025501170098005802550140011900740255016101400093025502000176013202550147012300790255014901240083025501910166012602550191016801270255019101670129025501930169013302550166014401070255008800650031025501150095006002550130011200760255013701210087025501320116008302550075006000290255003800230000025501160100007402550119010500790255006400490028025500380025000602550070005700380255009900860067025501210106008502550083006700440255007200540030025501050087006302550087006700430255011900990075025500900072004802550077005900350255013901210097025501240108008502550134011800950255008100640044025500730058003902550045003300170255006000510036025500580049003402550048004100250255003600290011025500640056003702550075006400440255007900670043025501020087006402550114009800730255008600690043025500870071004502550108009200670255011801040078025500950083005902550087007600540255012300960079025500810056003402550116009900730255016701520121025501590146011402550122010700780255010500850060025501030081005802550099007300500255013501090082025501730150011602550192017001290255018901680121025501800158011102550177015001050255017001430100025501870160011702550164013700940255018601590116025501790154011302550180015501140255016401410100025501260102006402550100007700430255008200620029025500750056002402550127011000820255008100640038025500970081005602550115009900760255011501000077025500470032001102550069005700350255007800660044025501410129010702550138012301000255012601100085025500720056003002550043002600000255006600490023025500950078005202550101008400580255009900810057025500760060003502550119010300800255009000750052025501030088006702550076006300440255005000380022025500590050003502550066005700420255007200650047025500550046002902550083007500560255010600950075025500820070004602550112009600730255014401260102025501480131010502550138012100950255013001140089025500510036001302550104009200700255011501040082025501330107008402550091006700390255014001240091025501610147011002550160014801100255011701030068025500720052002502550081005900350255014001140089025501180092006502550177015401200255020301810140025501830160011602550179015701100255013001030060025501660137009702550180015101110255015901300088025501610132009002550163013600930255017301460103025501580133009202550164014001020255009000670033025500790058002902550115009500700255013001120090025500820063004602550091007400560255011000930075025500920077005802550047003200130255005700420021025500570042001902550062004700240255012601100085025501040088006202550117010000720255009800780051025500940074004702550088006800410255009900820054025500760059003302550078006200370255009100750052025501010085006202550105009000690255008100660047025500570044002702550048003600200255006700550039025500670058004102550049003700210255007400630045025501010088006902550066005100280255011600980076025501350115009102550148012801040255010200820058025500990081005902550101008500620255010100860065025501110098007902550138011100840255011000870056025501000082004602550111009500590255013801240087025501150099006502550113009400640255008100600031025501330109008102550117009400630255016501420108025501590137009602550165014201000255015401300086025501470119007902550217018801480255020001710131025501430114007402550130010100590255017301460101025501580131008602550172014801040255012200980060025501450121008702550075005100250255004800260003025500660045002602550045002600110255006900500035025501720155013902550109009200740255002800130000025500520036001302550046003000050255006500490024025501210104007802550126010900810255010600890061025501040084005702550087006700400255010000800055025501010081005602550092007400500255010100830059025500870071004802550106009000670255009400780055025500580043002202550044002800120255003200190003025500560044002802550071005900430255005600450027025500950084006602550062004900300255008500700049025500830065004302550067004900250255009700770053025501140094007002550062004400220255005600400017025500870070005002550154013901180255008500550027025500910064003402550108008500530255016601460113025501110092005902550127010800760255012601070075025501390120008802550104008300520255010900890056025501190099006402550212019001510255021501920151025501800155011402550207017901390255019701690129025501950167012802550159013100920255014701190079025501270103005902550128010400600255012301000058025501280104006602550150012600920255011100870061025500590037001402550024000300000255010800890072025501090090007302550071005400340255003800220000025500530037001402550079006100370255007100510026025500970077005002550131011200820255013601170087025501000081005102550115009800700255008600690043025500760058003402550075005700330255008400660044025500940076005402550091007300510255008300650043025500710053002902550067005100280255005400390020025500360023000602550053004200240255006300520034025500790068005002550102009100730255008400730053025500910079005702550158014301200255012801120089025501150097007302550123010500810255009200760051025500690053002802550081006500420255008000640041025501440115008502550140011300830255013701120082025501200095006502550118009500640255016601450114025500980077004602550102008300510255011000910058025500410022000002550144012400890255015901370100025501770153011502550157013100940255018401590119025501850160012002550158013200950255015801340096025501990176013502550150012700860255012501020060025501230100005902550123009900610255013901160084025501710147011902550154013201080255005700360015025500760055003402550096007800560255009800800058025500750057003302550123010600800255007700570032025500650044001702550076005700270255014101220092025501130094006202550109009000600255011000930065025501000083005702550088007000460255011901010079025500860068004802550064004600240255007500570035025500840066004202550129011200860255013901210097025501080093007202550066005300340255003500240006025500340023000502550070005900410255009800870069025500680057003902550095008400640255011200970076025501570142011902550141012501000255011100950070025500760060003502550086007000450255007200560031025501220106008102550135010800780255015801310101025501520127009702550149012400940255016201390108025501640143011202550118009700660255013701160085025501590140010802550161014201090255010000800047025501400117008302550137011300790255012701030067025501050081004502550126010200660255012801050071025501590136010202550132011000730255018001580121025501610139010002550122010000610255011500930056025501110088005602550131010700790255014101200093025501560136011102550114009400700255010000800056025501100092006802550103008600600255011200950069025501100090006502550091007000430255009000710041025501140095006502550110009100610255012601070077025501090092006402550095007800520255009200740050025500950077005502550089007100490255009300750053025500800059003802550129010900850255013401140089025501210104007802550129011400930255008300700051025500490038002002550045003400160255008800790062025500950087006802550054004300250255002700160000025500720057003602550087007200490255010400880063025501060088006402550105008700630255007700590035025500700054003102550141012501020255009200650036025501390114008402550113008800580255014801230093025501820159012802550105008200510255012801070076025501320111008002550153013401020255018001610129025501230102007102550115009400630255016701440112025501580135010302550152012900970255014801250093025500840063003202550141012200890255013901200087025501350116008302550169014901140255012001000065025501130093005802550105008500520255010600860053025500760055002402550100008100510255010800890059025500860067003702550096007600490255007200520025025500780058003102550138011700900255011400930064025500930074004402550120010100710255011901000070025501080089005902550107009000620255012401070081025500820064004002550091007300510255010500870065025500740056003202550088006800440255010100810056025501250105007802550127011000840255011501000079025501060093007402550067005600380255007400630045025500730064004702550070006100440255006200510033025500590048003002550039002400050255005200370016025500660048002602550101008300590255011600980074025501140096007202550052003600130255011100950072025501130087006002550142011700870255010500800050025501580135010402550177015401230255014201190088025500990078004702550145012400930255009300740044025501680149011902550176015701270255008900700040025501190098007102550131011000830255016201410114025501710151012402550156013901090255012301070074025501010085005202550101008500520255017301540122025501530134010202550112009300600255012001020066025500850067003102550156013801000255014501250090025501360116008102550180016001250255011500950062025501250104007302550105008400530255009300720041025500890068003702550108008900570255009200730041025501030084005402550090007100410255005500350008025500550035001002550077005700330255009300720051025500910071004702550092007200480255013101110086025501230103007602550099007800490255009800780051025501020087006402550101008800690255008500740056025500790068005002550042003300160255004400350018025500710059004302550069005800400255009300780059025501240109008802550074005600340255009500770055025500950077005502550093007500530255007800610041025500960079005902550084006000340255009600720044025501260102007402550137011600870255019001660138025500990078004702550084006300340255011200930063025501140095006502550093007300460255013501150090025501200103007702550089007100470255008100630041025501460128010602550153013501130255010300870061025501000086005902550127011300860255008000640038025500920076005002550151013401060255013001130083025501510132009902550095007700390255012701090069025501600141010102550150013100910255011400940057025501020082004702550118009800650255015901390106025501480127009602550114009300620255010500860054025501080089005702550123010400740255011300930066025500670047002202550071005100270255011800970076025500920071005002550119009900750255010900890064025500900070004302550104008500550255009200710040025500750055002802550084006900460255007200590040025500570046002802550030001900010255004600370020025500620053003602550057004500290255003400220006025501000084006802550138012301040255012501070087025500970079005702550071005300330255009200740054025501390122010202550157014001200255012100990075025501380116009202550149012701030255017601560129025501470126009902550108008900590255010700870060025501420122009502550161014101160255014501270103025501030085006302550063004700240255011701000080025501070090007202550116010000840255008900730057025501300117009802550125011300910255013401210102025501290114009502550111009600750255013001140091025501250109008402550173015601260255013401180084025500770059002102550126010700670255016501460106025501750155011802550140012000850255009500720040025501420119008802550167014701140255016301430110025501330114008202550083006400320255011000910061025501080088006102550065004500200255008000600036025500930072005102550119009800770255014001200096025501390119009402550148012701000255014601250096025501080087005602550091007200420255005800430022025500360023000602550021000900000255001700050000025500190010000002550060005100360255004100290013025500300018000202550081006500490255011000950076025500540035001802550076005800380255005900400023025500730054003702550090007300550255011100940076025501450127010502550132011400920255016601480124025501590141011702550146012901030255007400570031025501230103007802550143012601000255015301350111025501040088006502550103008600660255007300580039025500640048003202550079006600500255006700530040025500420030001602550038002600120255005600440030025500490035002202550093007900660255013301170104025500980082006602550088007100530255010000840059025500980081005102550142012600920255010800900054025501020082004502550140012000850255019001700137025501280105007402550066004300120255008500640033025500880068003502550094007500430255010500860056025500650045001802550084006400390255010200820058025500900070004602550094007300520255009100700049025500970077005302550120010000750255011800970070025501040083005402550100007900480255011701000072025501190104008302550118010700890255009800860070025500650053003702550024001500000255006100520037025500660054004002550079006700510255007600630047025500340018000202550064004700310255006500460029025500950076005902550111009400780255002400070000025500790062004602550085006800500255008300660048025500910074005402550097008000600255009400780055025500760060003702550079006100370255006800520029025500980082005902550099008400630255006200460030025500580045002902550034002000070255003900270015025500370024001502550034002100120255004500320023025500310018000902550017000400000255002200090001025500270012000502550089007500640255010200860073025500990082006402550112009400700255010900920064025501180099006702550110009100590255008300620033025500950074004502550133010900830255008600620036025500890068003702550091007200390255010600870055025501010082005202550103008300560255009600760051025501040086006202550093007500530255007200540032025500690051002902550081006300390255010900920066025501100090006302550151013101040255015301340104025501020085005902550110009500740255009500840066025500720060004402550054004500300255004100310019025500750066005102550052004000260255011301010085025501220109009302550096008000640255004700300014025501050088007202550101008400680255013701190105025500530035002102550037002100060255010300870072025501150099008302550056004000240255004100260007025500650050003102550109009400730255015201350115025501230108008702550122010700860255012601110092025500740061004402550075006200460255007900670053025500730061004902550064005400440255006300500041025500500037002802550028001500060255003600210014025500200005000002550031001600090255001400000000025500600044003102550138012101050255011300950073025501290112008602550105008500580255011000910061025500800059003002550050002900020255005900350009025500820061003402550095007600440255007900600028025500950076004602550095007500480255013901190094025501470129010502550104008600640255009700790057025500990081005902550101008300610255007400560032025501090091006702550124010700810255014101240098025501200100007502550106009000650255009600830064025500860074005802550094008500700255008100720057025500300020000802550043003300210255008200700056025501120100008602550119010500920255009100780062025500450029001402550067004900350255009000720058025500800064004902550070005400390255014901330118025500690055004202550046003200190255002200080000025500840071005502550087007400580255008000670050025501180102008602550145013201130255013201190100025500880075005802550080006700510255006800550039025500340022000802550067005500430255006400520040025500420030001802550038002500090255009000770061025500900074005902550104008800750255007400580045025500640048003302550031001400000255003600190001025501050087006302550167015001240255019101710144025501360117008702550153013201030255012501040073025501170096006502550104008300520255010000810049025501090090005802550102008300530255010400840057025501010083005902550141012301010255014401260104025500700053003302550058004200190255009100750052025500750059003602550079006300400255012801120089025501170101007802550120010200800255006400470027025500920079006202550090007800620255010400950080025500850076006102550056004800350255004900410028025500870077006502550076006400500255006500510038025500160002000002550055003900260255012201060093025500760060004702550079006300500255005800420029025500570043003002550024001000000255002900150004025500350021001002550045003100180255004100270014025500420029001302550084007100550255008500720055025501040091007402550114010100840255010500920075025500470034001702550082006900530255010800950079025500430030001402550089007600590255008400690048025501230108008502550146012901090255013601210100025501180101008102550084006700470255007700600040025500370021000002550042002400000255013301160090025501710151012402550177015801280255011000910059025501430123009002550136011600830255013901190086025501420123009102550120010100710255010200820055025501140097007102550103008500630255013401180095025501260109008902550093007600560255009100750052025500950079005602550078006200390255009000750054025501030086006602550115010000810255009500780060025500880072005602550061004800320255006700550039025501030094007902550067005800430255007600680055025500530045003202550030002000080255006700570045025500300018000602550039002500120255011701030090025501780164015102550139012301100255010000860073025501030089007802550057004500330255003300160008025500390022001202550064004700370255007100550042025500610047003402550044003100150255004000270011025500580045002802550057004100250255010000850066025501170102008302550104008900700255008900740055025500890074005502550135012001010255013301170094025501220107007802550142012700960255016401470117025501360121009002550137012000920255009200770048025500690053002702550093007700510255007400580032025500480032000602550150013301050255012601090079025501220106007302550154013501020255014301250087025501370119008302550124010500730255010000810051025500960079005102550086006900430255005000320010025500820065004502550115009800780255006400490028025500830068004702550087007200510255008300680047025500770064004502550048003200160255007000570041025500840068005502550090007600630255006300510035025500430031001502550024001500000255005400440032025500670059004802550055004700360255007000620051025500160006000002550014000200000255001600040000025501300118010602550227021502030255017701630152025500630051003902550048003500260255003000200010025500300013000502550033001600080255002700100000025500490032002202550070005400410255008300690056025500930080006402550086007300560255005800430024025501000085006402550094007900580255009700810058025500980082005902550133011500930255016001420118025501470130010402550138012100910255011500990065025501110092006002550110009400610255012801120079025501280111008102550116009900730255008800720047025500800064004102550061004500220255004300250001025501090092006602550121010400740255014901330100025501510133009702550124010600700255012301040072025500880068004102550085006800420255007200540030025500500034001102550094007700570255007100560035025500820067004602550106009100700255009300810059025500870074005502550105009200750255009300800064025500660052003902550044003000210255003600220013025500380026001202550050003800220255002600160004025500110001000002550069006100500255008600780067025500140006000002550014000600000255003900290017025500220010000002550057004500330255006200500038025500380026001402550031002100090255003400240014025500290019000902550044002500180255006100420035025500350017000702550051003400240255005000340021025500290013000002550097008100660255010000840068025501220105008702550112009500750255010900930070025501230105008102550093007300480255014201220097025501450124009702550107008600590255013901180089025501140095006302550143012200930255013401150085025501360117008702550133011600900255012101030081025501030084006702550076005900430255006900510037025500460029001302550038002100030255009900810059025501090092006602550145012800980255013701210088025501010084005402550106008900610255010800910065025500580040001602550043002700040255005100340014025500930078005702550099008400630255004700350013025500720060003802550068005500360255007900670051025500900078006402550030001700080255004700340028025500940081007302550028001600020255006900570041025500310021000902550027001700050255004300350024025500310023001202550013000500000255004900410030025500350025001502550028001800080255005000380026025500280016000402550041003100210255002200120002025500440034002502550028001900100255004600270013025500680049003502550032001300000255003900220006025500470030001202550092007700560255007700600040025500600044002102550059004300200255006100450022025500740056003402550083006300390255005500350010025500640043001602550075005400270255008700660037025500960075004602550131011000810255012901080079025501360117008702550138011800910255012301060080025501390121010102550115009800820255008000620048025500820066005302550079006300500255004000240009025500580041002502550103008600660255009600800057025501510135011002550127011100860255015901430118025501340118009302550071005500300255009200760053025500920076005302550060004500240255006900540033025500620049003002550063005000330255009200800064025500520040002602550037002400150255004000270019025500400027002102550057004400360255005800460032025500360024000802550058004600320255006200500036025500310019000502550048003800260255004800380026025500700060004802550067005700470255004900390029025500630053004302550057004700370255001100010000025500160008000002550041003100210255002600180007025500810060003302550070004900220255011100910067025500780061003502550107009000620255011701020069025501450129009602550143012700940255016001430115025500900072004802550077005600350255004200210002025500770057003302550089006900440255011000900065025500850065003802550100008100510255012201030071025501300111008102550098008100510255011801010073025501300114008902550118010300800255010000870068025501110098008102550087007400580255007400620048025500460034002202550048003600220255004900370023025500870075006102550105009300770255013601250105025501340122010002550092008000560255007200580032025500500036001002550076006200360255004100260003025500380023000402550036002300070255003500210008025500400027001802550019000900000255006800580049025500400030002102550069005600470255009900870075025500740062004802550065005300370255009600800064025501230107009102550061004500290255005900430027025500610048003102550075006300470255007200620050025500590051004002550028002200100255003700310019025500390033002102550063005500420255003500250013025500680059004402550135011200800255008300620031025500710051002402550079005900320255015801420109025501590143010702550145013000910255015501390103025501450128009802550141012300990255010800900070025501240105008802550103008500630255007600580034025501150097007302550136011900930255012401070077025501020085005502550100008300530255010300880059025501150099007302550113009900730255008100660043025501030091006902550092007900620255007900670051025500490037002302550030002000080255002700170007025500250015000502550042003200230255007100610051025500910082006702550096008800690255008900780056025500380026000202550087007300470255007700630037025501130098007702550100008500660255014001260113025500620048003702550052003900310255006200520043025500600050004102550039002900190255006600540042025500770065005102550063005100370255009500820066025500950079006302550092007500570255006300450025025500750058003802550073005800390255007900660049025500920083006802550055004700340255004000340022025500640057004702550059005300410255006800600049025500400031001602550084007200580255006900480021025500970075005102550144012301020255009900780057025501430126009802550122010700740255013401200085025501540139010602550136011900930255014901310109025501300111009402550140012301070255009500780060025500780063004202550099008400630255014801340108025501030088005902550113009800690255010300880059025501100094006802550113009700710255006900550029025500760061003802550075006300410255007800650048025500940082006602550030001800040255006400520040025500440034002402550036002600160255001800090000025500150007000002550072006300480255005300440027025500330022000202550045003300110255011300980075025501150100007702550139012401030255013501190103025501350122010602550014000000000255010400910082025500970084007502550054004100320255005800460034025500470034001802550080006700500255010500920075025500790063004702550066004900310255007300560038025500470030001202550133011600980255010800920076025501050092007602550089007700630255006200520040025500730065005402550038003000190255000700000000025500210011000102550052003900300255004900370025025500610039001602550061004000190255008600650048025500880069005202550097008100580255008400690040025500690054002302550128011300820255011801000076025500970080006002550081006400480255010000840069025500990083006702550119010600870255004500320013025500380026000402550061004700210255012401100083025501130097007202550125011100850255012101070081025501340119009602550115010000790255008800730052025501070092007302550098008500680255004100280012025500450033001902550039002900170255003000200010025500500041003202550028002000090255004700370025025500320023000802550044003300150255011201010081025501140102008002550088007300520255016201470128025501490133011702550088007500590255003100170004025500530041002902550060004800360255002900170005025500750062004602550048003500180255003700220003025500440029001002550054003700170255005200350017025500770060004202550117010000820255010300860068025500860070005402550088007200570255002700130000025500300018000602550069005900470255005300430033025500300020001002550036002300140255004300300021025500770064005502550101008000630255004700280013025500520032002102550059004100270255007100540036025500750059003602550074005900300255007900640035025500580042001902550063004600280255007500570043025500870071005602550086007300570255006700560038025501130105008602550074006600450255005100390017025500410029000502550082006700440255009900840061025501070092006902550120010500820255013101140094025500900075005402550084006900500255006100480031025500580045002902550077006500510255007200620050025500490039002702550066005800470255006100530042025500340026001502550029001900070255005800460032025501410129011302550116010300860255008600730054025501460130011402550142012601100255004600330017025500320018000502550069005500420255008800740061025500610048003202550035001900030255007100560037025500780062003902550087006900470255006700490027025500440027000702550036001900010255006200470028025500860070005402550077006100460255002800120000025500480032001702550081006700540255007100570044025500450031002002550033001900080255007600630054025500610048003902550044003100230255005200330019025500530035002102550076005700500255006300450035025500560038002402550077006000400255011100950069025500900074004802550059004300200255005900420024025500500032001802550057004100260255003300200004025500210009000002550040003100140255009900910072025500760065004502550057004400250255005800450026025501110099007702550122010700860255012501100087025501160099007902550091007400540255006600490031025500610046002702550099008300670255011801050089025500920080006602550058004800360255007000600048025500650057004602550048004000290255003100230012025500210009000002550119010700930255009700840068025501670154013702550134011801020255011000940079025500350022000602550074006000470255007300590046025500750062004602550043002700110255009800810061025501220106008302550142012401000255011600960072025501070087006302550065004700250255002300060000025500400024000802550053003700210255004800320017025500190003000002550079006300470255007600590043025501150097008302550125010900940255004200260013025500550041003002550042002900200255001800050000025500600042003002550029001300000255002600090002025500290012000402550057004100280255004600310012025500670051002602550097008100550255006400460024025500600043002502550062004500290255004600300015025500900077006102550065005400360255003000210004025500260017000002550034002600070255003800270009025500640051003402550071005800390255010800930072025501150098007802550125010700850255009700790057025500880070005002550144012701090255007900640045025500900077006002550085007300570255006300540039025500650056004102550045003500230255006300550044025500560048003702550035002300110255004400320018025501280114010102550141012801120255009200790063025500140001000002550028001500000255005200390023025500620046003102550047003100150255008600690049025501210105008202550140012200980255016701470122025501470127010202550139011900950255010600880066025500490032001402550062004600300255008800750059025500870071005602550076006000440255007800610043025500820063004602550061004300230255008600670050025500660049003302550082006600510255006400500039025500710059004702550060004400310255003600220011025500800063005602550078006100530255009400780065025500850070005102550069005300280255005200360010025500660048002602550110009200720255008700680053025501230106009002550144012801120255009800850068025500810070005202550071005900430255003300240007025500450033001702550071005800410255008900760057025501260109009102550114009700770255009400760054025500620044002202550112009400720255011700990079025501160099007902550096008100620255008300700053025500690058004002550061004900330255006200530038025500910081006902550083007300610255005800460034025500230011000002550084007000570255005500410028025500400027001102550037002400080255005400410025025500410028001202550077006100450255009000750056025501120095007502550087006900450255017401540129025501550135010802550127010500810255013101110087025501330115009502550071005600370255007500590044025501040091007502550080006400490255009200760060025501030084006702550122010400820255011200910070025500650047002502550062004400240255008400680052025500890076006002550060004800340255005100380022025500330021000702550067005300440255009200780069025500980084007102550085007000510255007100550030025501020086006002550128011000860255012601050084025501290108008902550150013201120255011700990079025500660049002902550061004600270255005200390022025500550043002702550079006700510255006500520035025500800067004802550074005700390255005100340014025500600042002002550067004600250255011600950074025501100092007002550138012000980255011200950075025501010086006502550076006300440255006100500032025500360025000702550060004800340255008100690055025500480036002202550040002600130255004900330020025500510035002202550043002900160255005800440031025500560043002702550062004900330255008000640048025501040089006802550092007600530255012201040080025501590139011402550099007900540255013801160093025501180097007602550074005500380255009800820066025500790063004802550109009600800255008700710056025500630048002902550108009000700255012001020080025500740054003002550066004800240255009300750053025501240109008802550094008100620255004100300010025500760065004502550101008900730255005800460034025500520040002802550046003300170255006400520030025501770163013702550136012100920255012101030079025501430123009902550141012000990255008200610040025500650044002302550104008600640255007300550035025500590042002402550084007100540255006400510034025500510038002102550047003200130255008900720052025500960078005602550083006200410255011900990075025501260106008202550094007400500255009500750051025500890071004902550066005000270255006100460023025500800068004602550066005300340255005300400023025500680055003902550088007500590255008800720057025500710055004002550051003500220255006400480035025500500036002302550078006500490255007800650048025501160100008402550114009900780255008600700047025500600042001802550041002100000255010700870062025501000079005802550108008700680255008000630047025500820066005102550069005500420255010800940081025500970081006602550091007600570255008900720052025500720054003202550065004700230255010600890063025501150099007402550176016201360255008500730049025500250015000002550047003500130255004900360017025500370025001102550031001900070255004900360020025500570045002302550105009100650255014501300101025501690151012702550116009600720255009700750054025501370115009402550098007600530255012801080084025500710050002902550103008500650255013401190100025500990084006502550070005500360255005900420024025500810063004302550057003600150255009000690048025501540132010902550164014201190255012901090084025501230103007802550107008900650255008500670043025500760060003502550092007600510255007200570034025500800065004402550071005600350255008600710052025500900073005502550070005300370255009300770062025500600044003102550060004400310255007000570041025500820069005202550068005500380255006600510030025500590043002002550049003100070255007200520027025501170097007302550116009500760255011000910076025500460029001302550045002900140255008000660053025500880074006102550119010300880255009200760060025500640047002902550088007200490255006700510026025501110095007002550096008000550255012301090083025500990087006102550070006000330255010600910068025500520040001802550020000700000255003600220009025500650052003602550037002400050255006100470021025501410127010002550156013801140255009000690048025501120091007002550093007200510255007800560033025500690049002502550110008900680255005900410019025501150098007802550094007700570255011200950075025500630045002502550045002400030255005300320011025500690047002402550123010100780255015601340110025501170095007102550094007400490255010200820057025500940074004702550122010500770255012201050077025500820065003902550086006900430255009500770053025500840066004402550084006600460255007500580040025500600043002702550082006600510255008900730060025500920079006302550062004900330255005700440027025500710058003902550121010600850255011701010078025500700052002802550095007700550255007300540037025500580040002602550070005400390255005300370022025500830067005402550116010000870255013601200105025500940078006302550045002900130255006000450026025500760061004002550101008600630255010300880065025500680056003202550080006800440255013801280101025501400124009902550059004400210255006100450030025500790065005402550059004500320255002500140000025500450033001102550055004000170255008400690046025501040087006702550051003300130255003400160000025500970077005302550172015401300255017901610139025501620144012202550062004400220255010300850063025501000082006002550059003800170255016601460122025501330111008802550101007900560255006200400017025501540132010802550132011000860255011000890062025500940073004602550128010700780255011700980068025500980079004902550055003600060255010500860056025500790060003002550075005500280255012201020078025500890071005102550048003100130255004600300015025500780062004702550089007600600255009100790063025500670056003802550055004200230255006300480029025501020085006502550100008300630255005100340014025500460030001402550045002900140255004800320017025500580042002702550085006900540255009500790064025501020086007302550101008500720255006100470034025500550042002602550028001600000255004900380020025500490038001802550069005600370255006200500028025501220110008602550076005900330255004900330010025500600042002802550086006900590255004400300019025500410029001302550103009200720255011201000078025501090096007702550103008800690255004600290011025500350018000002550110009400710255014301270102025501740156013402550124010600840255008000600036025501040084005902550103008100580255012201000077025501220100007702550145012301000255014301210098025501050083006002550112009000660255013601140090025501030082005502550123010200730255010500840053025500980077004602550083006200310255006200420009025501220102006902550120010000670255009400730044025500930071004702550107008600650255009000720052025500570040002402550053003700220255005700440028025500950083006702550069005800400255006800570039025500770064004702550093007800590255007200550037025500720057003802550093007900660255006800540041025500800064005102550079006300480255008800700056025500640046003202550040002400110255007700630052025500870075006302550062005200420255003300230011025500150005000002550049004000250255005400430025025500350022000302550094008100620255008700670042025501090088006702550110009200800255008700700062025500430029002002550025001300000255005900480030025500780067004702550129011801000255007200590042025500250012000002550042002700080255008300680045025500840069004602550097008000600255010900930070025501390117009302550103008200550255012701030079025501190097007302550089006700430255013301110087025501640142011802550127010500810255006400420018025500760054003002550126010200760255009900750047025501090086005502550074005100190255007900560024025501100087005302550122010000630255011100880054025501120089005802550092007100440255009800780054025501040086006602550095007800620255003300170001025500180005000002550060004800320255007300640047025501140103008502550098008500680255008000670050025500860070005402550101008500690255008500730061025500860074006202550069005500420255005500390026025500760058004402550047002900150255003700210008025500270013000202550048003800290255002800190010025500450036002902550034002500160255002900210010025500180009000002550029001700010255006200490032025501050083005902550081005900380255014301240110025500700052004202550059004500360255005400420030025500430031001502550052004400250255005000380022025500660054003802550035002200060255005800450028025500920077005802550066005100300255009800830062025500820066004302550093007100480255014801240100025500850061003502550096007200460255013001080084025501170095007102550098007600520255009100690045025500930071004702550057003500110255006300390013025500890065003702550132010900780255009000670035025501090086005202550111008800540255011200880052025501050081004502550136011300810255010800870058025500750053002902550061004300210255009200750057025500640048003202550035002200060255004300310015025500630051003502550070005800420255006200500034025500620049003302550063005000340255007900660050025500980086007402550049003500240255006700510038025500590041002902550062004400300255006900510037025500560040002702550053003900280255004000270018025500500040003102550057004800390255004100320023025500320024001302550024001400020255003300210007025500660053003702550109008400620255010700850064025500680046003202550077005700460255007700600050025500370025001302550025001300000255002700150000025500460033001602550093008000640255013001140099025500820066005102550063004600300255008600690051025500880071005302550110009200720255013001050085025501380111009002550105008100570255010700830059025500870066003902550088006700400255009300710047025501000078005402550131010900860255010500830060025500930071004702550079005700330255011900980069025501070086005502550093007300400255011600930059025501240100006402550114009000540255011800950063025501150094006302550099007800510255007000520028025500830066004602550082006700480255006400510034025500200008000002550046003400200255005200400026025500610049003502550067005500410255004600340020025500660054004002550083006900560255006000440031025501060088007402550084006600520255010000820068025500890073005802550044002800130255005100350022025500630049003602550038002600120255004800360022025500440032001802550038002600120255004400320018025500500038002202550073006100450255010400800054025501450121009702550081005800400255005400350020025500820064005002550084007100550255007300600043025501080095007602550138012501060255007700620043025500880072005602550058004200260255008300660050025500970080006202550068005100310255009100730051025500860064004302550084005900370255009400700046025501040080005402550108008700600255009500740047025500960075004802550131010900850255011900970073025501270105008202550082006000370255009900770053025500690048002102550070004900200255009700770044025501140094005902550123009900630255012601020066025501380115008302550134011300820255012101000071025500990082005602550078006200390255006000450024025500410028001102550057004400280255003900270013025500220010000002550038002800160255006400540042025500520042003002550051003900250255006600500035025500660048003402550084006600520255010700890075025500990083006802550082006600510255006200460031025500690053003802550069005600400255004700340018025500750062004602550088007500590255006300510035025500480036002002550053004100250255006800560040025501070082005102550107008400530255012000980074025500890069004502550127010900870255010200860063025500940078005302550126011200850255015801440117025501040088006202550053003700140255007100540034025500970080006002550103008700640255009600820056025500900074004902550072005200280255007600540030025500700048002402550095007400470255013201110084025501130092006302550118009700680255018001590132025501170095007102550116009400700255011600960072025501130093006902550111009100660255008100610034025501260107007702550119010000670255010800850051025501380114007802550127010400720255010600850054025501260105007602550086006900430255007200560031025500840069004802550100008700700255007200590042025500420030001402550030001800020255001900070000025500480036002202550090008100660255006300510037025500710055004002550092007500590255009700800064025500610044002802550075005900430255005700410025025500480032001602550067005100350255008000640048025500690053003702550113010000830255009600830066025500510038002102550051003800210255004600330016025500880075005802550093006900350255010700820051025501080084005602550143012100970255008200620037025500960079005302550111009400660255011901020072025501260109007902550064004700190255007500580032025500630047002202550073005700340255008200660043025501240110008402550115009900730255011701000074025501250105008002550077005700300255010700860057025501110090006102550113009200630255011600950066025501290108007902550109008800610255010500830059025501220102007802550100008000560255010200820057025500980081005502550095007800500255010100820052025500910068003602550098007500410255008900660034025500840063003202550085006500380255007800610035025500740058003302550093007800570255007700640045025500880075005802550059004700310255005200400024025500220010000002550045003300170255006900600045025500720060004402550092007600600255004300260010025500890072005602550053003600200255007300570041025500910075005902550075005900430255007700610045025500800064004802550058004200260255012501120095025500740061004202550070005700400255006500520033025500430030001302550069005600370255011000850054025500960071004102550123009900730255012301010077025500920072004702550103008300580255010200830053025500870068003602550078005900270255005800390009025500550035001002550135011700930255008800720049025500790063004002550073005800350255011200980072025500910075004902550139012200960255009600790051025501230104007402550109009000600255013001110079025501310110007902550120009900700255012601050078025501220100007602550099007900550255010500850061025500990081005702550077006100360255010500890063025500980081005302550105008400530255011100880056025501020079004702550109008800570255009400740047025500790062003602550102008600610255008500700049025500830070005102550116010300840255008700760058025500550044002602550029001800000255004300320014025500600048003202550074006300450255005700410025025500480033001402550061004600270255009200770058025500850070005102550123010800890255012901140095025500760061004202550062004700280255008200670048025500900075005602550081006600450255008500720053025500580046002402550060004700280255005200400018025501030080004902550109008500570255010200800056025500780056003302550104008400600255009300730048025500940075004502550077005800260255009100700039025501260105007602550099007700530255009600760052025500890071005102550077006000400255008000650042025501110096007302550068005200270255009300770051025501040087005902550070005300230255010900900060025501030084005202550108008700560255011000890058025501220101007202550109008800610255009900770053025500940074005002550082006400400255006200460021025500820068004202550090007400480255008800690039025500930072004102550106008500560255009700780048025501110094006802550085006900440255010000850062025500970082006102550097008400650255011100980079025500770066004802550047003600180255006300520034025500450034001602550054004300250255006200510033025500350020000102550070005500360255007900640045025500990084006502550107009200730255011601010082025500870072005302550104008900700255009400790060025501060091007202550105009000690255009900840063025501160104008202550067005500330255003800260004025500560044002202550082006200370255006800480024025500650044002302550045002400050255006900510029025500950075005102550144012400970255006400430014025501210098006702550159013801090255009900770053025501020082005802550087006900490255003600190000025501040089006802550109009400710255008600720046025500870071004502550066004900230255006700500022025500930074004402550105008400550255013101080077025500990076004502550106008200540255009100700043025501050084005702550089006900440255005400360012025500630047002202550105009000670255008600700045025500890069004202550092007300430255009300730046025500990082005602550102008400600255009100750052025500960081005802550086007100500255008100680049025500900077005802550072005900420255007200590042025500770066004802550079006800500255007600650045025500700059003902550062004700280255012401090090025500860071005202550056004100220255007300580039025500800065004602550104008900700255008700720053025501010086006702550125011000910255010100860067025500660051003202550058004300220255008100660045025500670052003102550087007200510255006800520029025500500034001102550043002600080255007800610043025500660049002902550109009100690255010900890062025500800059002802550112008900580255015501320101025501280107008002550102008000570255006100400019025500720054003202550102008600630255009500800057025500940079005602550087007100460255008900710047025500610044001802550081006000330255012601050076025501290105007702550094007000420255008500610033025501040080005202550049002800010255005500350008025500490029000402550052003400100255005800420017025500670051002602550091007400480255009600790053025501030085006102550081006500400255006900530030025500780061004102550078006300420255007100560037025500720059004002550065005200330255007100580041025500690056003902550055004400260255007100600042025500700059003902550047003400150255008500700051025500710056003702550059004400250255006400490030025500590044002502550069005400350255008700720053025500830068004902550064004900300255006200470028025500520037001802550062004700280255006600510032025501170102008102550135012000990255010500900069025500500039001702550050003900170255007000570038025501150102008302550079006400430255011300970074025501030086005802550133011400820255011300930060025501200097006502550111008700590255011200910064025500810061003602550075005700330255006600500024025500650049002402550087007100480255010900920072025501010083006302550076005800360255006200400017025500920070004602550093006900430255011400880061025501130087006002550121009800670255014501240095025501190099007202550088006800410255008900720046025500690053002702550081006500400255007600600035025500650049002402550091007500520255007800610041025500820065004502550100008500660255009100760057025500550039002302550052003900220255008500720055025500740061004402550058004500280255004100280011025500770064004702550062004900320255008600730056025500950080006102550144012901100255011701020083025500540039002002550050003400180255005100350019025500610045002902550074005800420255006800520036025500680052003602550095007900630255013401190100025500690054003502550072005700380255007700620043025500520037001802550045003700160255004900410020025500460034001802550068005700390255008100680051025501030088006502550101008600570255011000940061025501210101006802550124010100690255013201080080025501090088006102550101008100560255006700500024025500820065003902550044002800020255006500480028025500830066004802550114009600760255010800900070025500600039001802550103008100580255013101070083025501310105008002550127010100740255012601020074025501160095006602550127010600770255012001000073025500740057002902550073005600300255008400680043025500680052002902550058004100210255007000530033025500810064004402550089007400550255007900640045025500660050003402550061004500290255006500520035025500590046002902550068005500380255005600430026025500630050003302550053004000230255004100280011025500740061004202550079006400450255012501100091025500850070005102550058004300240255009000740058025500480032001602550078006200460255006000440028025500530037002102550048003200160255005800420026025500830067005102550101008600670255005600410022025500330018000002550058004300240255006400570039025500410034001602550027001700050255003900270013025500520040002602550061004800290255010100850060025501040087005902550131011200800255012401030072025501270106007902550095007300490255008800680044025500720054003002550087007000440255007400580033025500730056003602550082006500470255005600370020025500750057003702550108008700680255009900770056025501070085006202550092006800440255013601120086025501840160013202550167014601170255013501140085025501240104007702550096007900510255008900720046025500750059003402550087007000500255006800530034025500580043002402550100008500660255010800920076025500690053003702550052003900220255006800550038025500580045002802550066005300360255004900360019025500650052003502550043002700110255004900330017025501150100008102550117010200830255008000630045025500570040002002550047003000120255009300760058025501100094007802550080006400480255005500390023025500720056004002550046003000140255005000340018025500490033001702550077006100450255006900540035025500880073005402550096008100620255009200770058025500640055004002550034002500100255003100210009025500280015000602550050003800260255006200490033025500770062003902550126011000840255012001030075025500880069003902550094007200480255012501050081025500910070004902550113009500730255010700910066025500490033000802550052003500150255007500580040025500700051003402550080006100440255012401060086025501080087006802550114009300720255013801160093025501310109008502550119009800710255013301120085025501220103007302550108008800610255008600660039025500830066004002550087007100460255006500500029025500740059004002550051003600170255007000550036025500720056004002550050003400180255007500620045025500770064004702550076006300460255005800450028025500600047003002550062004900320255006300470031025500500035001602550076006100420255011601010080025500920075005502550051003400140255004700300010025500970080006202550113009800790255009400780062025500990083006702550073005700410255007800620046025500620046003002550074005800420255010600900074025501180103008402550097008200630255009400790060025500810066004702550040002800120255004600340020025500390027001502550044003000210255005700430032025500460033001702550069005400350255011701010076025501030086006002550094007700510255009400730052025501750154013502550138012001000255007500580038025500820065004502550093007800550255007800630040025500820067004602550050003300130255009400770057025500940077005902550077005900390255008900710051025500970076005502550133011300880255011500950068025501120092006502550124010700790255012201050079025500840067004102550081006300390255008400680043025500970082006102550094008200600255008700750053025500430031000902550049003600170255007400610042025500710058003902550063005000310255008700720053025500610046002702550052003700180255005100360017025500720057003802550059004400230255005400390018025501160101008002550089007300500255008100650042025500540038001502550105008800680255012001030083025500920075005702550091007600570255011400990080025500590043002702550057004100250255007400590040025500840069005002550087007400550255008400710052025500840071005202550060004700280255002900140000025500420026001002550074005800450255008600700057025500690053004002550036002000040255004400270007025500410025000002550042002500000255010500880062025501210103007902550114009600740255006100440024025501160101008002550102008700640255011601010078025500590045001902550088007300500255011000950072025500890074005302550114009700790255009300760058025500860069004902550095007800580255006800520027025500730057003102550104008800620255010200850059025501170100007402550095007700530255011400960072025501000084006102550068005300300255006900570035025500520040001802550061004900270255005900460027025500770064004502550078006500460255010100880069025500740059004002550074005900400255006900540035025500850070004902550061004600250255007500600039025500430028000702550059004400210255007100550030025500730057003202550081006500400255010800920069025500890073005002550055003800180255007200570038025500360021000202550080006400480255006200460030025500620047002802550065005000310255008100680049025500490036001702550087007400550255005300400021025500530035001102550106008800640255013901220102025501100093007502550107009000720255010500890066025501100094006802550084006900400255008100640034025500970080005002550134011700890255013701210095025500990083005802550067005300270255007900680040025501040093006502550058004400170255005300390012025500920077005402550075006300410255006300480029025500830068004902550060004500260255007500600039025501030088006502550115010100750255005400400014025500750059003402550094007800530255010700910068025501360120009702550112009700740255008300710047025500930083005802550066005600310255006100510026025500460034001202550075006300410255008300710049025500810069004702550084006900480255007300580037025500630048002702550081006600430255007500600037025500810066004302550060004500220255006100460023025500590043001702550074005700310255009800810055025501280110008602550147013101080255008200660043025500570040002002550046002900090255005200370018025500620047002802550067005200330255007000550036025500750063004102550057004500230255010300910069025500540042002002550101008100540255006300430018025500840066004202550093007500530255015901430120025501800164013902550150013501060255017601610128025501870171013802550151013501020255011400990068025500650050002102550062004800220255004400330005025500540043001502550041003200010255005400400011025500740060003302550057004500190255006700550031025501130100008102550128011500960255008600730054025501030091006902550053004100190255005200400016025500620048002202550063004900230255007300570034025500600044002102550096007900590255010400890068025501050093006902550086007600510255008700770052025500730063003802550059004700250255004400320010025500840072005002550081006900470255007900640043025500630048002702550066005100280255005300380015025500690054003102550090007500520255008400690046025500720058003202550063004600200255008100640036025500960079005302550089007200460255009500790056025500870071004802550103008600660255012401070087025500880073005402550080006500460255005200370018025500440029001002550042003000080255007900670045025500960084006202550090007800560255";


void tearDownGL()
{
}

#include <math.h>



struct Vertex3D {
	GLfloat a, b, c;
};
static Vertex3D rectVertices[] = {
   {-1.0,  1.0, -0.0},
   { 1.0,  1.0, -0.0},
   {-1.0, -1.0, -0.0},
   { 1.0, -1.0, -0.0}
};
static Vertex3D rectNormals[] = {
   {0.0, 0.0, 1.0},
   {0.0, 0.0, 1.0},
   {0.0, 0.0, 1.0},
   {0.0, 0.0, 1.0}
};
static GLfloat rectTexCoords[] = {
   0.0, 1.0,
   1.0, 1.0,
   0.0, 0.0,
   1.0, 0.0
};

void Texture::load(std::string path)
{
	int dimx = 64;
	int dimy = 64;

	GLubyte* target_data = new GLubyte[dimx * dimy * 4];
	for (int i = 0; i < dimx * dimy * 4; i++)
	{
		//int a = stone_data[4 * i + 0] - 48;
		int b = stone_data[4 * i + 1] - 48;
		int c = stone_data[4 * i + 2] - 48;
		int d = stone_data[4 * i + 3] - 48;

		target_data[i] = b * 100 + c * 10 + d;
	}

	glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
	glGenTextures(1, &texture_id);
	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_2D, texture_id);
	glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, dimx, dimy, 0, GL_RGBA, GL_UNSIGNED_BYTE, target_data);

	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
}
void Texture::render(float px, float py, float dx, float dy)
{
	glEnableClientState(GL_VERTEX_ARRAY);
	glEnableClientState(GL_NORMAL_ARRAY);
	glEnableClientState(GL_TEXTURE_COORD_ARRAY);

	glBindTexture(GL_TEXTURE_2D, texture_id);
	glActiveTexture(GL_TEXTURE0);
	glVertexPointer(3, GL_FLOAT, 0, rectVertices);
	glNormalPointer(GL_FLOAT, 0, rectNormals);
	glTexCoordPointer(2, GL_FLOAT, 0, rectTexCoords);

	glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

	glDisableClientState(GL_VERTEX_ARRAY);
	glDisableClientState(GL_NORMAL_ARRAY);
	glDisableClientState(GL_TEXTURE_COORD_ARRAY);
}
void box(float dx, float dy, float dz)
{

}
void rect(float px, float py, float dx, float dy)
{

}
void background(float r, float g, float b, float a)
{
	glClearColor(r, g, b, a);
	glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
}
void pushMap(double px, double py, double pz)
{
	glMatrixMode(GL_MODELVIEW);
	glLoadIdentity();
	glRotatef(myPlayer.angx, 1.0, 0.0, 0);
	glRotatef(myPlayer.angy, 0, 1.0, 0);

	glTranslatef(px - myPlayer.px, py - myPlayer.py, pz - myPlayer.pz);

}
void popMap()
{
	glMatrixMode(GL_MODELVIEW);
	glLoadIdentity();
}
//Player
void Player::update()
{
	if (isMousePressed)
	{
		int buttonx = (10 * mouseX / WIDTH);
		int buttony = (5 * mouseY / HEIGHT);
		float walkspeed = 0.03;
		if (buttonx == 0 && buttony == 4)
		{
			move2D(-M_PI_2, walkspeed);
			//myPlayer.px -= walkspeed;
		}
		if (buttonx == 2 && buttony == 4)
		{
			move2D(M_PI_2, walkspeed);
			//myPlayer.px += walkspeed;
		}

		if (buttonx == 1 && buttony == 3)
		{
			move2D(0, walkspeed);
			//myPlayer.pz -= walkspeed;
		}
		if (buttonx == 1 && buttony == 4)
		{
			move2D(M_PI, walkspeed);
			//myPlayer.pz += walkspeed;
		}

		if (buttonx == 0 && buttony == 3)
		{
			myPlayer.py += walkspeed;
		}
		if (buttonx == 2 && buttony == 3)
		{
			myPlayer.py -= walkspeed;
		}
	}
}



//////////////////////////////////////////////
/*		Helper Functions					*/
//////////////////////////////////////////////
//#include <stdio.h>
#include <iostream>
#include <fstream>
#include <stdio.h>
#include <math.h>
#include <float.h>
#include <errno.h>
#include <fenv.h>

void println(std::string text) {

	FILE* file = fopen((base_game_path + "/glesoutput.txt").c_str(), "a+");
	std::string comb = text + "\n";
	const char* as_char = comb.c_str();
	//fprintf(file, "%s", as_char); //comb.c_str());
	//fclose(file);
}
std::string float_to_string(float val) {
	char c[50];
	sprintf(c, "%g", val);
	return std::string(c);
}

std::string int_to_string(int val) {
	char c[10];
	sprintf(c, "%d", val);
	return std::string(c);
}
float my_exp(int n) {
	float val = 1.0;
	for (int i = 0; i < n; i++)
		val *= 10;
	return val;
}
int millis()
{
	auto end = std::chrono::high_resolution_clock::now();
	auto dur = end - begin_millis_timer;
	auto ms = std::chrono::duration_cast<std::chrono::milliseconds>(dur).count();
	return ms;
}
MyFile load_file(std::string path)
{
	FILE* pFile = fopen((base_game_path + "/" + path).c_str(), "rb");
	fseek(pFile, 0, SEEK_END);
	long lSize = ftell(pFile);
	rewind(pFile);
	char* buffer = (char*)malloc(sizeof(char) * lSize);
	fread(buffer, 1, lSize, pFile);
	fclose(pFile);
	return MyFile{ buffer, (int)lSize };
}
void save_file(MyFile file, std::string path)
{
	FILE* pFile = fopen((base_game_path + "/" + path).c_str(), "wb");
	fwrite(file.data, sizeof(char), file.length * sizeof(char), pFile);
	fclose(pFile);
}
//fill noFill stroke noStroke
void sphere(float r)
{
}
void text(std::string s, float scale)
{

}

//TODO
void download_from_link()
{

}
void play_mp3()
{

}
void connect_ip()
{

}
/*
AAssetDir* assetDir = AAssetManager_openDir(mgr, "");
const char* filename = (const char*)NULL;
while ((filename = AAssetDir_getNextFileName(assetDir)) != NULL) {
	AAsset* asset = AAssetManager_open(mgr, filename, AASSET_MODE_STREAMING);
	char buf[BUFSIZ];
	int nb_read = 0;
	FILE* out = fopen(filename, "w");
	while ((nb_read = AAsset_read(asset, buf, BUFSIZ)) > 0)
		fwrite(buf, nb_read, 1, out);
	fclose(out);
	AAsset_close(asset);
}
AAssetDir_close(assetDir);
	*/
